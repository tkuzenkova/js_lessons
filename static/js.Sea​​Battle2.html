
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Java Script</title>
    <script type="text/javascript" src="script.js"></script>
    <style> 
        body{margin:0;}
        #field table {
            border-spacing: 0;
            border-collapse: collapse;
            margin: 20px;
        }
        #field table td {
            border:1px solid #333;
            width:20px;
            height:20px;
            background: #f3f5fe;
            text-align: center;
            vertical-align: middle;
        }
        #field table td.ship{
            background: #f77878;
        }
    </style>
</head>
<body>

<div id="field"></div>

<script type="text/javascript">

function getRandomInt(min, max) {
    return Math.floor( Math.random() * (max - min + 1) ) + min;
}

var width = 10;// Math.floor( +prompt("Введите ширину поля", "10") );

if ( width == '' || width != width ) {
    alert("Введены некорректные данные")
} else if ( width <= 3 ) {
    alert("Ширина слишком мала. Минимальное значение ширины 4")
} else if ( width > 20 ) {
    alert("Ширина слишком велика. Максимальное значение ширини 20")
};

// resetField (); устанавливает состояние is_opened всех ячеек в false и заново генерирует все корабли
function resetField () {
    var fieldInner = [];

    for (var i = 0; i < width; i++) {

        fieldInner[i] = [];

        for (var j = 0; j < width; j++) {
                
            var cell = {

                is_opened: false,
                //is_ship: ( getRandomInt(1,4) == 2 ) ? true : false
                is_ship: false

            }

            fieldInner[i][j] = cell;
        }
    }
    return fieldInner;
};

var field = resetField ();


// проверить возможность поставить корабль
function validatePoint(x, y) {
    if ( x >= 0 && x <= width-1 && y >= 0 && y <= width-1) {
        if (
               ( ( x-1 == -1 ) || ( y-1 == -1 ) || !field[x-1][y-1].is_ship ) 
            && ( ( x-1 == -1 ) || !field[x-1][y].is_ship )
            && ( ( x-1 == -1 ) || ( y+1 == width ) || !field[x-1][y+1].is_ship )
            && ( ( y-1 == -1 ) || !field[x][y-1].is_ship )
            && !field[x][y].is_ship 
            && ( ( y+1 == width ) || !field[x][y+1].is_ship )
            && ( ( y-1 == -1 ) || ( x+1 == width ) || !field[x+1][y-1].is_ship )
            && ( ( x+1 == width ) || !field[x+1][y].is_ship )
            && ( ( x+1 == width ) || ( y+1 == width ) || !field[x+1][y+1].is_ship )
        ) {
            return true;
        } else if (
               ( ( x-1 == -1 ) || ( y-1 == -1 ) || field[x-1][y-1].is_ship ) 
            || ( ( x-1 == -1 ) || field[x-1][y].is_ship )
            || ( ( x-1 == -1 ) || ( y+1 == width ) || field[x-1][y+1].is_ship )
            || ( ( y-1 == -1 ) || field[x][y-1].is_ship )
            || field[x][y].is_ship 
            || ( ( y+1 == width ) || field[x][y+1].is_ship )
            || ( ( y-1 == -1 ) || ( x+1 == width ) || field[x+1][y-1].is_ship )
            || ( ( x+1 == width ) || field[x+1][y].is_ship )
            || ( ( x+1 == width ) || ( y+1 == width ) || field[x+1][y+1].is_ship )

        ) {
            return false;
        } 
    } 
    return false;
}

validatePoint(-9,0)

//Создать поле
function createField () {
    
    var table = document.createElement('table');

    for (var i = 0; i < width; i++) {
        var tr = document.createElement('tr');

        for (var j = 0; j < width; j++) {

            var td = document.createElement('td');

            if ( field[i][j].is_ship ) {
               td.innerHTML = "s";
               td.setAttribute('class', 'ship');
            };
            tr.appendChild(td);
        };
        table.appendChild(tr);
    };

    document.getElementById('field').appendChild(table);
    return table;

}

createField ();
//console.log(  );

</script>

</body>
</html>
